<!DOCTYPE html>
<html lang="ko" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Bitget Trading System v3.0 - ÎåÄÏãúÎ≥¥Îìú</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/dashboard/css/main.css">
    <link rel="stylesheet" href="/dashboard/css/themes.css">
    <link rel="stylesheet" href="/dashboard/css/telegram-notifications.css">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Ìó§Îçî -->
    <header class="header">
        <div class="header-content">
            <div class="header-title">
                <i class="fas fa-rocket"></i>
                Bitget Trading System v3.0
            </div>
            
            <div class="header-controls">
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span id="system-status">Ïã§Ìñâ Ï§ë</span>
                </div>
                
                <div class="status-indicator">
                    <i class="fas fa-wifi"></i>
                    <span id="websocket-status">Ïó∞Í≤∞Îê®</span>
                </div>
                
                <div class="status-indicator">
                    <i class="fas fa-clock"></i>
                    <span id="last-update">-</span>
                </div>
                
                <button class="theme-toggle" onclick="toggleTheme()">
                    <i class="fas fa-moon" id="theme-icon"></i>
                    <span id="theme-text">Îã§ÌÅ¨</span>
                </button>
                
                <button class="theme-toggle" onclick="refreshData()">
                    <i class="fas fa-sync-alt" id="refresh-icon"></i>
                    ÏÉàÎ°úÍ≥†Ïπ®
                </button>
            </div>
        </div>
    </header>

    <!-- Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà -->
    <div class="container">
        <!-- ÏµúÏÉÅÎã® ÏöîÏïΩ ÏÑπÏÖò -->
        <div class="summary-grid">
            <div class="summary-card" id="total-balance-card">
                <div class="summary-label">Ï¥ù ÏûêÏÇ∞</div>
                <div class="summary-value" id="total-balance">$0</div>
                <div class="summary-change" id="balance-change">
                    <i class="fas fa-arrow-up"></i>
                    <span>+0%</span>
                </div>
            </div>
            
            <div class="summary-card" id="daily-pnl-card">
                <div class="summary-label">Ïò§Îäò ÏÜêÏùµ</div>
                <div class="summary-value" id="daily-pnl">$0</div>
                <div class="summary-change" id="daily-change">
                    <i class="fas fa-arrow-up"></i>
                    <span>+0%</span>
                </div>
            </div>
            
            <div class="summary-card" id="realized-pnl-card">
                <div class="summary-label">Ïã§ÌòÑ ÏÜêÏùµ</div>
                <div class="summary-value" id="realized-pnl">$0</div>
                <div class="summary-change" id="realized-change">
                    <i class="fas fa-arrow-up"></i>
                    <span>+0%</span>
                </div>
            </div>
            
            <div class="summary-card" id="unrealized-pnl-card">
                <div class="summary-label">ÎØ∏Ïã§ÌòÑ ÏÜêÏùµ</div>
                <div class="summary-value" id="unrealized-pnl">$0</div>
                <div class="summary-change" id="unrealized-change">
                    <i class="fas fa-arrow-up"></i>
                    <span>+0%</span>
                </div>
            </div>
        </div>

        <!-- ÏûêÎ≥∏ Ï∂îÏ†Å ÏÑπÏÖò -->
        <div class="capital-tracking-section">
            <div id="capital-tracker-container"></div>
        </div>

        <!-- Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú Í∑∏Î¶¨Îìú -->
        <div class="dashboard-grid">
            <!-- Ìè¨ÏßÄÏÖò ÏÑπÏÖò -->
            <div class="positions-section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-chart-line"></i>
                        ÌôúÏÑ± Ìè¨ÏßÄÏÖò
                        <span class="badge" id="positions-count">0</span>
                    </div>
                    
                    <div class="filters">
                        <button class="filter-btn active" data-filter="all">Ï†ÑÏ≤¥</button>
                        <button class="filter-btn" data-filter="BTC">BTC</button>
                        <button class="filter-btn" data-filter="ETH">ETH</button>
                        <button class="filter-btn" data-filter="XRP">XRP</button>
                        
                        <select id="sort-select" class="filter-btn" style="padding: 0.375rem 0.75rem;">
                            <option value="symbol">Ï¢ÖÎ™©Ïàú</option>
                            <option value="pnl">ÏÜêÏùµÏàú</option>
                            <option value="size">ÌÅ¨Í∏∞Ïàú</option>
                            <option value="time">ÏãúÍ∞ÑÏàú</option>
                        </select>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="positions-table">
                        <thead>
                            <tr>
                                <th>Ï¢ÖÎ™©</th>
                                <th>Î∞©Ìñ•</th>
                                <th>ÌÅ¨Í∏∞</th>
                                <th>ÏßÑÏûÖÍ∞Ä</th>
                                <th>ÌòÑÏû¨Í∞Ä</th>
                                <th>ÏÜêÏùµÎ•†</th>
                                <th>ÏÜêÏùµ ($)</th>
                                <th>Ïï°ÏÖò</th>
                            </tr>
                        </thead>
                        <tbody id="positions-tbody">
                            <tr>
                                <td colspan="8" class="text-center" style="color: var(--text-muted); padding: 2rem;">
                                    <i class="fas fa-chart-line" style="font-size: 2rem; opacity: 0.3; margin-bottom: 1rem; display: block;"></i>
                                    ÌôúÏÑ± Ìè¨ÏßÄÏÖòÏù¥ ÏóÜÏäµÎãàÎã§
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ÏúÑÏ†Ø ÏÑπÏÖò -->
            <div class="widgets-section">
                <!-- Î¶¨Ïä§ÌÅ¨ ÎØ∏ÌÑ∞ -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-tachometer-alt"></i>
                        Î¶¨Ïä§ÌÅ¨ ÎØ∏ÌÑ∞
                    </div>
                    <div class="risk-meter">
                        <svg width="120" height="60" viewBox="0 0 120 60">
                            <defs>
                                <linearGradient id="riskGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:var(--profit-green)"/>
                                    <stop offset="50%" style="stop-color:var(--warning-orange)"/>
                                    <stop offset="100%" style="stop-color:var(--loss-red)"/>
                                </linearGradient>
                            </defs>
                            <path class="risk-arc" d="M 20 50 A 40 40 0 0 1 100 50" stroke="var(--border-color)" stroke-width="8"/>
                            <path class="risk-arc active" id="risk-arc-active" d="M 20 50 A 40 40 0 0 1 60 20" stroke="url(#riskGradient)" stroke-width="8"/>
                        </svg>
                    </div>
                    <div class="risk-value" id="risk-percentage">25%</div>
                    <div class="text-center" style="color: var(--text-muted); font-size: 0.875rem;">ÌòÑÏû¨ ÏúÑÌóòÎèÑ</div>
                </div>

                <!-- ÏÜêÏùµ Ïä§ÌååÌÅ¨ÎùºÏù∏ -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-chart-area"></i>
                        24ÏãúÍ∞Ñ ÏÜêÏùµ Ï∂îÏù¥
                    </div>
                    <div class="sparkline-container">
                        <svg class="sparkline" id="pnl-sparkline" viewBox="0 0 300 60">
                            <defs>
                                <linearGradient id="sparklineGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:var(--profit-green);stop-opacity:0.3"/>
                                    <stop offset="100%" style="stop-color:var(--profit-green);stop-opacity:0"/>
                                </linearGradient>
                            </defs>
                            <path class="sparkline-area" d="M0,60 L0,30 L75,25 L150,20 L225,35 L300,15 L300,60 Z"/>
                            <path class="sparkline-path" d="M0,30 L75,25 L150,20 L225,35 L300,15"/>
                        </svg>
                    </div>
                    <div class="text-center">
                        <span style="color: var(--profit-green); font-weight: 600;" id="sparkline-change">+2.5%</span>
                        <span style="color: var(--text-muted); margin-left: 0.5rem;">ÏßÄÎÇú 24ÏãúÍ∞Ñ</span>
                    </div>
                </div>

                <!-- Îπ†Î•∏ ÌÜµÍ≥Ñ -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-chart-pie"></i>
                        Îπ†Î•∏ ÌÜµÍ≥Ñ
                    </div>
                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="win-rate">0%</div>
                            <div class="stat-label">ÏäπÎ•†</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="avg-win">$0</div>
                            <div class="stat-label">ÌèâÍ∑† ÏàòÏùµ</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="avg-loss">$0</div>
                            <div class="stat-label">ÌèâÍ∑† ÏÜêÏã§</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="total-trades">0</div>
                            <div class="stat-label">Ï¥ù Í±∞Îûò</div>
                        </div>
                    </div>
                </div>

                <!-- AI Ïã†Î¢∞ÎèÑ -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-brain"></i>
                        AI ÏòàÏ∏° Ïã†Î¢∞ÎèÑ
                    </div>
                    <div class="ai-confidence">
                        <div class="confidence-bar">
                            <div class="confidence-fill" id="confidence-fill" style="width: 75%;"></div>
                        </div>
                        <div class="confidence-value" id="confidence-value">75%</div>
                    </div>
                    <div class="text-center mt-2" style="color: var(--text-muted); font-size: 0.875rem;">
                        ÌòÑÏû¨ ÏòàÏ∏° Î™®Îç∏ Ïã†Î¢∞ÎèÑ
                    </div>
                </div>

                <!-- ÌÖîÎ†àÍ∑∏Îû® ÏïåÎ¶º ÌÜµÌï© ÏúÑÏ†Ø -->
                <div class="widget" id="telegram-widget-container">
                    <!-- ÌÖîÎ†àÍ∑∏Îû® ÏïåÎ¶º ÏúÑÏ†ØÏù¥ Ïó¨Í∏∞Ïóê Î°úÎìúÎê©ÎãàÎã§ -->
                </div>

                <!-- ÏãúÏû• ÏÉÅÌÉú -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-chart-bar"></i>
                        ÏãúÏû• ÏÉÅÌÉú
                    </div>
                    <div class="text-center">
                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">
                            <span id="market-volatility">Î≥¥ÌÜµ</span>
                        </div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">
                            Î≥ÄÎèôÏÑ±: <span id="volatility-level">Ï§ëÍ∞Ñ</span>
                        </div>
                        <div style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.25rem;">
                            Ï∂îÏÑ∏: <span id="market-trend">Ìö°Î≥¥</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏµúÍ∑º Í±∞Îûò ÏÑπÏÖò -->
        <div class="positions-section" style="margin-top: 2rem;">
            <div class="section-header">
                <div class="section-title">
                    <i class="fas fa-history"></i>
                    ÏµúÍ∑º Í±∞Îûò
                </div>
                <div>
                    <button class="filter-btn" onclick="exportTrades()">
                        <i class="fas fa-download"></i>
                        ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                    </button>
                </div>
            </div>
            
            <div class="table-container">
                <table class="positions-table">
                    <thead>
                        <tr>
                            <th>ÏãúÍ∞Ñ</th>
                            <th>Ï¢ÖÎ™©</th>
                            <th>Î∞©Ìñ•</th>
                            <th>ÌÅ¨Í∏∞</th>
                            <th>ÏßÑÏûÖÍ∞Ä</th>
                            <th>Ï¢ÖÎ£åÍ∞Ä</th>
                            <th>ÏÜêÏùµ ($)</th>
                            <th>ÏÜêÏùµÎ•†</th>
                        </tr>
                    </thead>
                    <tbody id="trades-tbody">
                        <tr>
                            <td colspan="8" class="text-center" style="color: var(--text-muted); padding: 2rem;">
                                <i class="fas fa-history" style="font-size: 2rem; opacity: 0.3; margin-bottom: 1rem; display: block;"></i>
                                ÏµúÍ∑º Í±∞ÎûòÍ∞Ä ÏóÜÏäµÎãàÎã§
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Î™ÖÎ†πÏñ¥ ÌåîÎ†àÌä∏ Î™®Îã¨ -->
    <div id="command-palette" class="command-palette" style="display: none;">
        <div class="command-palette-content">
            <div class="command-search">
                <i class="fas fa-search"></i>
                <input type="text" id="command-input" placeholder="Î™ÖÎ†πÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." autocomplete="off">
            </div>
            <div class="command-list" id="command-list">
                <!-- Î™ÖÎ†πÏñ¥ Î™©Î°ùÏù¥ ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>
        </div>
    </div>

    <!-- ÏïåÎ¶º ÌÜ†Ïä§Ìä∏ Ïª®ÌÖåÏù¥ÎÑà -->
    <div id="toast-container" class="toast-container"></div>

    <!-- ÌôïÏù∏ Î™®Îã¨ -->
    <div id="confirm-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirm-title">ÌôïÏù∏</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirm-message"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Ï∑®ÏÜå</button>
                <button class="btn btn-danger" id="confirm-action">ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <!-- JavaScript ES6 Modules -->
    <!-- Main script will be loaded at the end -->
    
    <!-- Loading Screen -->
    <div class="loading-screen">
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">
                <h2>üöÄ Bitget Trading System v3.0</h2>
                <p>ÎåÄÏãúÎ≥¥Îìú Ï¥àÍ∏∞Ìôî Ï§ë...</p>
            </div>
            <div class="loading-progress">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="loading-steps">
                    <div class="step active">ÏãúÏä§ÌÖú Î°úÎìú</div>
                    <div class="step">ÏÑúÎπÑÏä§ Ïó∞Í≤∞</div>
                    <div class="step">Ïª¥Ìè¨ÎÑåÌä∏ Ï¥àÍ∏∞Ìôî</div>
                    <div class="step">ÏôÑÎ£å</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Error Boundary -->
    <div id="error-boundary" class="error-boundary" style="display: none;">
        <div class="error-content">
            <h2>‚ö†Ô∏è Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§</h2>
            <p class="error-message"></p>
            <button class="error-retry">Îã§Ïãú ÏãúÎèÑ</button>
            <button class="error-reload">ÏÉàÎ°úÍ≥†Ïπ®</button>
        </div>
    </div>

    <style>
    /* Loading Screen Styles */
    .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--bg-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s ease-out;
    }

    .loading-screen.fade-out {
        opacity: 0;
        pointer-events: none;
    }

    .loading-container {
        text-align: center;
        max-width: 400px;
        padding: 2rem;
    }

    .loading-spinner {
        width: 60px;
        height: 60px;
        border: 4px solid var(--border-color);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 2rem;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .loading-text h2 {
        color: var(--text-primary);
        margin: 0 0 0.5rem;
        font-size: 1.5rem;
    }

    .loading-text p {
        color: var(--text-muted);
        margin: 0 0 2rem;
    }

    .loading-progress {
        width: 100%;
    }

    .progress-bar {
        width: 100%;
        height: 4px;
        background: var(--border-color);
        border-radius: 2px;
        overflow: hidden;
        margin-bottom: 1rem;
    }

    .progress-fill {
        height: 100%;
        background: var(--primary-color);
        width: 0%;
        animation: progress 3s ease-in-out infinite;
    }

    @keyframes progress {
        0% { width: 0%; }
        50% { width: 70%; }
        100% { width: 100%; }
    }

    .loading-steps {
        display: flex;
        justify-content: space-between;
        font-size: 0.875rem;
    }

    .step {
        color: var(--text-muted);
        transition: color 0.3s ease;
    }

    .step.active {
        color: var(--primary-color);
        font-weight: 500;
    }

    /* Toast Styles */
    .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 10000;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .toast {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 1rem;
        max-width: 400px;
        box-shadow: var(--shadow-medium);
        animation: slideIn 0.3s ease-out;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .toast.success { border-left: 4px solid var(--success-color); }
    .toast.warning { border-left: 4px solid var(--warning-color); }
    .toast.error { border-left: 4px solid var(--error-color); }
    .toast.info { border-left: 4px solid var(--info-color); }

    .toast-icon {
        font-size: 1.2rem;
        flex-shrink: 0;
    }

    .toast-content {
        flex: 1;
    }

    .toast-message {
        color: var(--text-primary);
        font-weight: 500;
        margin: 0 0 4px;
    }

    .toast-action {
        background: transparent;
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
        padding: 4px 12px;
        border-radius: 4px;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .toast-action:hover {
        background: var(--primary-color);
        color: white;
    }

    .toast-close {
        background: none;
        border: none;
        color: var(--text-muted);
        cursor: pointer;
        font-size: 1.2rem;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        transition: background 0.2s ease;
    }

    .toast-close:hover {
        background: var(--border-color);
    }

    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

    /* Error Boundary Styles */
    .error-boundary {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10001;
    }

    .error-content {
        background: var(--bg-secondary);
        border-radius: 12px;
        padding: 2rem;
        max-width: 500px;
        text-align: center;
        box-shadow: var(--shadow-large);
    }

    .error-content h2 {
        color: var(--error-color);
        margin: 0 0 1rem;
    }

    .error-message {
        color: var(--text-primary);
        margin: 0 0 2rem;
        line-height: 1.6;
    }

    .error-retry,
    .error-reload {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        margin: 0 8px;
        transition: background 0.2s ease;
    }

    .error-retry:hover,
    .error-reload:hover {
        background: var(--primary-color-dark);
    }

    .error-reload {
        background: var(--border-color);
        color: var(--text-primary);
    }

    .error-reload:hover {
        background: var(--text-muted);
    }

    /* App Loaded State */
    body:not(.app-loaded) .container {
        display: none;
    }

    body.app-loaded .loading-screen {
        display: none;
    }
    </style>

    <!-- Í∞ïÌôîÎêú Ïä§ÌÅ¨Î¶ΩÌä∏ Î°úÎî© ÏãúÏä§ÌÖú -->
    <script>
        // ES6 Î™®Îìà Î°úÎìú ÏãúÎèÑ
        let moduleLoaded = false;
        let moduleError = null;
        
        // Î™®Îìà Î°úÎìú ÌÉÄÏûÑÏïÑÏõÉ
        const moduleTimeout = setTimeout(() => {
            if (!moduleLoaded) {
                console.error('‚ùå Î™®Îìà Î°úÎìú ÌÉÄÏûÑÏïÑÏõÉ');
                forceShowDashboard('module_timeout');
            }
        }, 6000);
        
        // ÎèôÏ†Å Î™®Îìà Î°úÎìú
        async function loadMainModule() {
            try {
                console.log('üì¶ Î©îÏù∏ Î™®Îìà Î°úÎìú ÏãúÏûë...');
                const module = await import('/dashboard/src/main.js');
                moduleLoaded = true;
                clearTimeout(moduleTimeout);
                console.log('‚úÖ Î©îÏù∏ Î™®Îìà Î°úÎìú ÏÑ±Í≥µ');
            } catch (error) {
                moduleError = error;
                console.error('‚ùå Î©îÏù∏ Î™®Îìà Î°úÎìú Ïã§Ìå®:', error);
                clearTimeout(moduleTimeout);
                
                // Fallback ÏãúÏä§ÌÖú Ïã§Ìñâ
                setTimeout(() => {
                    if (!document.body.classList.contains('app-loaded')) {
                        forceShowDashboard('module_error');
                    }
                }, 1000);
            }
        }
        
        // ES6 Î™®Îìà ÏßÄÏõê ÌôïÏù∏ ÌõÑ Î°úÎìú
        if ('noModule' in HTMLScriptElement.prototype) {
            // ES6 Î™®Îìà ÏßÄÏõê
            loadMainModule();
        } else {
            // ES6 Î™®Îìà ÎØ∏ÏßÄÏõê
            console.warn('‚ö†Ô∏è ES6 Î™®Îìà ÎØ∏ÏßÄÏõê Î∏åÎùºÏö∞Ï†Ä');
            setTimeout(() => {
                forceShowDashboard('no_module_support');
            }, 2000);
        }
    </script>
    
    <!-- Fallback for browsers that don't support ES6 modules -->
    <script nomodule>
        console.warn('‚ö†Ô∏è ES6 Î™®Îìà ÎØ∏ÏßÄÏõê - Fallback Î™®Îìú');
        setTimeout(function() {
            forceShowDashboard('no_module_support');
        }, 3000);
    </script>

    <!-- Global functions for theme and refresh -->
    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Update theme text and icon
            const themeText = document.getElementById('theme-text');
            const themeIcon = document.getElementById('theme-icon');
            if (themeText && themeIcon) {
                themeText.textContent = newTheme === 'dark' ? 'Îã§ÌÅ¨' : 'ÎùºÏù¥Ìä∏';
                themeIcon.className = newTheme === 'dark' ? 'fas fa-moon' : 'fas fa-sun';
            }
        }

        function refreshData() {
            // Trigger refresh event
            if (window.dashboardApp) {
                window.dashboardApp.handleRefreshAll();
            } else {
                location.reload();
            }
        }

        // Initialize theme on load
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
        });

        // Í∞ïÌôîÎêú Î¨¥ÌïúÎ°úÎî© Î∞©ÏßÄ ÏãúÏä§ÌÖú
        let loadingTimeout;
        let emergencyTimeout;
        let scriptLoadFailed = false;
        
        // 1Ï∞® ÌÉÄÏûÑÏïÑÏõÉ: 5Ï¥à ÌõÑ Í≤ΩÍ≥†
        setTimeout(function() {
            const loadingScreen = document.querySelector('.loading-screen');
            if (loadingScreen && loadingScreen.style.display !== 'none' && !document.body.classList.contains('app-loaded')) {
                console.warn('‚ö†Ô∏è 5Ï¥à ÌõÑÏóêÎèÑ Î°úÎî© Ï§ë - Í≥ß Í∞ïÏ†ú ÌëúÏãúÎê©ÎãàÎã§');
                
                // Î°úÎî© Î©îÏãúÏßÄ ÏóÖÎç∞Ïù¥Ìä∏
                const loadingText = document.querySelector('.loading-text p');
                if (loadingText) {
                    loadingText.textContent = 'Ï¥àÍ∏∞ÌôîÍ∞Ä ÏßÄÏó∞ÎêòÍ≥† ÏûàÏäµÎãàÎã§...';
                }
            }
        }, 5000);
        
        // 2Ï∞® ÌÉÄÏûÑÏïÑÏõÉ: 8Ï¥à ÌõÑ Í∞ïÏ†ú ÌëúÏãú
        emergencyTimeout = setTimeout(function() {
            const loadingScreen = document.querySelector('.loading-screen');
            if (loadingScreen && !document.body.classList.contains('app-loaded')) {
                console.log('üö® Emergency: 8Ï¥à ÌÉÄÏûÑÏïÑÏõÉ - Í∞ïÏ†ú ÎåÄÏãúÎ≥¥Îìú ÌëúÏãú');
                forceShowDashboard('timeout');
            }
        }, 8000);
        
        // 3Ï∞® ÏïàÏ†ÑÏû•Ïπò: 15Ï¥à ÌõÑ ÏôÑÏ†Ñ Í∞ïÏ†ú ÌëúÏãú
        setTimeout(function() {
            if (!document.body.classList.contains('app-loaded')) {
                console.log('üö® CRITICAL: 15Ï¥à ÌÉÄÏûÑÏïÑÏõÉ - ÏôÑÏ†Ñ Í∞ïÏ†ú ÌëúÏãú');
                forceShowDashboard('critical_timeout');
            }
        }, 15000);
        
        function forceShowDashboard(reason) {
            console.log(`üö® Í∞ïÏ†ú ÎåÄÏãúÎ≥¥Îìú ÌëúÏãú - ÏõêÏù∏: ${reason}`);
            
            try {
                // Î°úÎî© ÌôîÎ©¥ Ïà®Í∏∞Í∏∞
                const loadingScreen = document.querySelector('.loading-screen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
                
                // Ïª®ÌÖåÏù¥ÎÑà Î≥¥Ïù¥Í∏∞
                const container = document.querySelector('.container');
                if (container) {
                    container.style.display = 'block';
                }
                
                // Ïï± Î°úÎìú ÏôÑÎ£å ÌëúÏãú
                document.body.classList.add('app-loaded');
                
                // ÏóêÎü¨ ÏÉÅÌÉú ÌëúÏãú
                showEmergencyDashboard(reason);
                
                // ÌÉÄÏûÑÏïÑÏõÉ Ï†ïÎ¶¨
                if (emergencyTimeout) clearTimeout(emergencyTimeout);
                
            } catch (error) {
                console.error('‚ùå Í∞ïÏ†ú ÌëúÏãú Ï§ë Ïò§Î•ò:', error);
                // ÏµúÌõÑÏùò ÏàòÎã®: ÌéòÏù¥ÏßÄ Î¶¨Î°úÎìú
                setTimeout(() => location.reload(), 1000);
            }
        }
        
        function showEmergencyDashboard(reason) {
            const container = document.querySelector('.container');
            if (!container) return;
            
            // ÏóêÎü¨ Î∞∞ÎÑà Ï∂îÍ∞Ä
            const errorBanner = document.createElement('div');
            errorBanner.id = 'emergency-banner';
            errorBanner.style.cssText = `
                background: linear-gradient(135deg, #ff4444, #cc0000);
                color: white;
                padding: 1rem;
                text-align: center;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 10000;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            `;
            
            const reasonTexts = {
                'timeout': 'Ï¥àÍ∏∞Ìôî ÏãúÍ∞Ñ Ï¥àÍ≥º',
                'critical_timeout': 'Ïã¨Í∞ÅÌïú Î°úÎî© ÏßÄÏó∞',
                'script_error': 'Ïä§ÌÅ¨Î¶ΩÌä∏ Î°úÎìú Ïã§Ìå®',
                'module_error': 'Î™®Îìà Î°úÎìú Ïã§Ìå®'
            };
            
            errorBanner.innerHTML = `
                <div style="max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;">
                    <div>
                        <strong>‚ö†Ô∏è Í∏¥Í∏â Î™®Îìú:</strong> ${reasonTexts[reason] || reason} - Í∏∞Î≥∏ Í∏∞Îä•Îßå ÏÇ¨Ïö© Í∞ÄÎä•
                    </div>
                    <div style="margin-top: 0.5rem;">
                        <button onclick="location.reload()" style="background: white; color: #cc0000; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; margin-right: 0.5rem;">
                            üîÑ ÏÉàÎ°úÍ≥†Ïπ®
                        </button>
                        <button onclick="document.getElementById('emergency-banner').style.display='none'" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid white; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">
                            ‚úï Ïà®Í∏∞Í∏∞
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertBefore(errorBanner, document.body.firstChild);
            
            // Ïª®ÌÖåÏù¥ÎÑà ÏÉÅÎã® ÎßàÏßÑ Ï∂îÍ∞Ä
            container.style.marginTop = '80px';
        }
    </script>
</body>
</html>