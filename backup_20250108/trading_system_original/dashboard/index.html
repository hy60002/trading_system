<!DOCTYPE html>
<html lang="ko" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ Bitget Trading System v3.0 - ëŒ€ì‹œë³´ë“œ</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/dashboard/css/main.css">
    <link rel="stylesheet" href="/dashboard/css/themes.css">
    <link rel="stylesheet" href="/dashboard/css/telegram-notifications.css">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- í—¤ë” -->
    <header class="header">
        <div class="header-content">
            <div class="header-title">
                <i class="fas fa-rocket"></i>
                Bitget Trading System v3.0
            </div>
            
            <div class="header-controls">
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span id="system-status">ì‹¤í–‰ ì¤‘</span>
                </div>
                
                <div class="status-indicator">
                    <i class="fas fa-wifi"></i>
                    <span id="websocket-status">ì—°ê²°ë¨</span>
                </div>
                
                <div class="status-indicator">
                    <i class="fas fa-clock"></i>
                    <span id="last-update">-</span>
                </div>
                
                <button class="theme-toggle" onclick="toggleTheme()">
                    <i class="fas fa-moon" id="theme-icon"></i>
                    <span id="theme-text">ë‹¤í¬</span>
                </button>
                
                <button class="theme-toggle" onclick="refreshData()">
                    <i class="fas fa-sync-alt" id="refresh-icon"></i>
                    ìƒˆë¡œê³ ì¹¨
                </button>
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="container">
        <!-- ìµœìƒë‹¨ ìš”ì•½ ì„¹ì…˜ -->
        <div class="summary-grid">
            <div class="summary-card" id="total-balance-card">
                <div class="summary-label">ì´ ìì‚°</div>
                <div class="summary-value" id="total-balance">$0</div>
                <div class="summary-change" id="balance-change">
                    <i class="fas fa-arrow-up"></i>
                    <span>+0%</span>
                </div>
            </div>
            
            <div class="summary-card" id="daily-pnl-card">
                <div class="summary-label">ì˜¤ëŠ˜ ì†ìµ</div>
                <div class="summary-value" id="daily-pnl">$0</div>
                <div class="summary-change" id="daily-change">
                    <i class="fas fa-arrow-up"></i>
                    <span>+0%</span>
                </div>
            </div>
            
            <div class="summary-card" id="realized-pnl-card">
                <div class="summary-label">ì‹¤í˜„ ì†ìµ</div>
                <div class="summary-value" id="realized-pnl">$0</div>
                <div class="summary-change" id="realized-change">
                    <i class="fas fa-arrow-up"></i>
                    <span>+0%</span>
                </div>
            </div>
            
            <div class="summary-card" id="unrealized-pnl-card">
                <div class="summary-label">ë¯¸ì‹¤í˜„ ì†ìµ</div>
                <div class="summary-value" id="unrealized-pnl">$0</div>
                <div class="summary-change" id="unrealized-change">
                    <i class="fas fa-arrow-up"></i>
                    <span>+0%</span>
                </div>
            </div>
        </div>

        <!-- ìë³¸ ì¶”ì  ì„¹ì…˜ -->
        <div class="capital-tracking-section">
            <div id="capital-tracker-container"></div>
        </div>

        <!-- ë©”ì¸ ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ -->
        <div class="dashboard-grid">
            <!-- í¬ì§€ì…˜ ì„¹ì…˜ -->
            <div class="positions-section">
                <div class="section-header">
                    <div class="section-title">
                        <i class="fas fa-chart-line"></i>
                        í™œì„± í¬ì§€ì…˜
                        <span class="badge" id="positions-count">0</span>
                    </div>
                    
                    <div class="filters">
                        <button class="filter-btn active" data-filter="all">ì „ì²´</button>
                        <button class="filter-btn" data-filter="BTC">BTC</button>
                        <button class="filter-btn" data-filter="ETH">ETH</button>
                        <button class="filter-btn" data-filter="XRP">XRP</button>
                        
                        <select id="sort-select" class="filter-btn" style="padding: 0.375rem 0.75rem;">
                            <option value="symbol">ì¢…ëª©ìˆœ</option>
                            <option value="pnl">ì†ìµìˆœ</option>
                            <option value="size">í¬ê¸°ìˆœ</option>
                            <option value="time">ì‹œê°„ìˆœ</option>
                        </select>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="positions-table">
                        <thead>
                            <tr>
                                <th>ì¢…ëª©</th>
                                <th>ë°©í–¥</th>
                                <th>í¬ê¸°</th>
                                <th>ì§„ì…ê°€</th>
                                <th>í˜„ì¬ê°€</th>
                                <th>ì†ìµë¥ </th>
                                <th>ì†ìµ ($)</th>
                                <th>ì•¡ì…˜</th>
                            </tr>
                        </thead>
                        <tbody id="positions-tbody">
                            <tr>
                                <td colspan="8" class="text-center" style="color: var(--text-muted); padding: 2rem;">
                                    <i class="fas fa-chart-line" style="font-size: 2rem; opacity: 0.3; margin-bottom: 1rem; display: block;"></i>
                                    í™œì„± í¬ì§€ì…˜ì´ ì—†ìŠµë‹ˆë‹¤
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ìœ„ì ¯ ì„¹ì…˜ -->
            <div class="widgets-section">
                <!-- ë¦¬ìŠ¤í¬ ë¯¸í„° -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-tachometer-alt"></i>
                        ë¦¬ìŠ¤í¬ ë¯¸í„°
                    </div>
                    <div class="risk-meter">
                        <svg width="120" height="60" viewBox="0 0 120 60">
                            <defs>
                                <linearGradient id="riskGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:var(--profit-green)"/>
                                    <stop offset="50%" style="stop-color:var(--warning-orange)"/>
                                    <stop offset="100%" style="stop-color:var(--loss-red)"/>
                                </linearGradient>
                            </defs>
                            <path class="risk-arc" d="M 20 50 A 40 40 0 0 1 100 50" stroke="var(--border-color)" stroke-width="8"/>
                            <path class="risk-arc active" id="risk-arc-active" d="M 20 50 A 40 40 0 0 1 60 20" stroke="url(#riskGradient)" stroke-width="8"/>
                        </svg>
                    </div>
                    <div class="risk-value" id="risk-percentage">25%</div>
                    <div class="text-center" style="color: var(--text-muted); font-size: 0.875rem;">í˜„ì¬ ìœ„í—˜ë„</div>
                </div>

                <!-- ì†ìµ ìŠ¤íŒŒí¬ë¼ì¸ -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-chart-area"></i>
                        24ì‹œê°„ ì†ìµ ì¶”ì´
                    </div>
                    <div class="sparkline-container">
                        <svg class="sparkline" id="pnl-sparkline" viewBox="0 0 300 60">
                            <defs>
                                <linearGradient id="sparklineGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:var(--profit-green);stop-opacity:0.3"/>
                                    <stop offset="100%" style="stop-color:var(--profit-green);stop-opacity:0"/>
                                </linearGradient>
                            </defs>
                            <path class="sparkline-area" d="M0,60 L0,30 L75,25 L150,20 L225,35 L300,15 L300,60 Z"/>
                            <path class="sparkline-path" d="M0,30 L75,25 L150,20 L225,35 L300,15"/>
                        </svg>
                    </div>
                    <div class="text-center">
                        <span style="color: var(--profit-green); font-weight: 600;" id="sparkline-change">+2.5%</span>
                        <span style="color: var(--text-muted); margin-left: 0.5rem;">ì§€ë‚œ 24ì‹œê°„</span>
                    </div>
                </div>

                <!-- ë¹ ë¥¸ í†µê³„ -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-chart-pie"></i>
                        ë¹ ë¥¸ í†µê³„
                    </div>
                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="win-rate">0%</div>
                            <div class="stat-label">ìŠ¹ë¥ </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="avg-win">$0</div>
                            <div class="stat-label">í‰ê·  ìˆ˜ìµ</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="avg-loss">$0</div>
                            <div class="stat-label">í‰ê·  ì†ì‹¤</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="total-trades">0</div>
                            <div class="stat-label">ì´ ê±°ë˜</div>
                        </div>
                    </div>
                </div>

                <!-- AI ì‹ ë¢°ë„ -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-brain"></i>
                        AI ì˜ˆì¸¡ ì‹ ë¢°ë„
                    </div>
                    <div class="ai-confidence">
                        <div class="confidence-bar">
                            <div class="confidence-fill" id="confidence-fill" style="width: 75%;"></div>
                        </div>
                        <div class="confidence-value" id="confidence-value">75%</div>
                    </div>
                    <div class="text-center mt-2" style="color: var(--text-muted); font-size: 0.875rem;">
                        í˜„ì¬ ì˜ˆì¸¡ ëª¨ë¸ ì‹ ë¢°ë„
                    </div>
                </div>

                <!-- í…”ë ˆê·¸ë¨ ì•Œë¦¼ í†µí•© ìœ„ì ¯ -->
                <div class="widget" id="telegram-widget-container">
                    <!-- í…”ë ˆê·¸ë¨ ì•Œë¦¼ ìœ„ì ¯ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>

                <!-- ì‹œì¥ ìƒíƒœ -->
                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-chart-bar"></i>
                        ì‹œì¥ ìƒíƒœ
                    </div>
                    <div class="text-center">
                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">
                            <span id="market-volatility">ë³´í†µ</span>
                        </div>
                        <div style="color: var(--text-muted); font-size: 0.875rem;">
                            ë³€ë™ì„±: <span id="volatility-level">ì¤‘ê°„</span>
                        </div>
                        <div style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.25rem;">
                            ì¶”ì„¸: <span id="market-trend">íš¡ë³´</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ìµœê·¼ ê±°ë˜ ì„¹ì…˜ -->
        <div class="positions-section" style="margin-top: 2rem;">
            <div class="section-header">
                <div class="section-title">
                    <i class="fas fa-history"></i>
                    ìµœê·¼ ê±°ë˜
                </div>
                <div>
                    <button class="filter-btn" onclick="exportTrades()">
                        <i class="fas fa-download"></i>
                        ë‚´ë³´ë‚´ê¸°
                    </button>
                </div>
            </div>
            
            <div class="table-container">
                <table class="positions-table">
                    <thead>
                        <tr>
                            <th>ì‹œê°„</th>
                            <th>ì¢…ëª©</th>
                            <th>ë°©í–¥</th>
                            <th>í¬ê¸°</th>
                            <th>ì§„ì…ê°€</th>
                            <th>ì¢…ë£Œê°€</th>
                            <th>ì†ìµ ($)</th>
                            <th>ì†ìµë¥ </th>
                        </tr>
                    </thead>
                    <tbody id="trades-tbody">
                        <tr>
                            <td colspan="8" class="text-center" style="color: var(--text-muted); padding: 2rem;">
                                <i class="fas fa-history" style="font-size: 2rem; opacity: 0.3; margin-bottom: 1rem; display: block;"></i>
                                ìµœê·¼ ê±°ë˜ê°€ ì—†ìŠµë‹ˆë‹¤
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ëª…ë ¹ì–´ íŒ”ë ˆíŠ¸ ëª¨ë‹¬ -->
    <div id="command-palette" class="command-palette" style="display: none;">
        <div class="command-palette-content">
            <div class="command-search">
                <i class="fas fa-search"></i>
                <input type="text" id="command-input" placeholder="ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." autocomplete="off">
            </div>
            <div class="command-list" id="command-list">
                <!-- ëª…ë ¹ì–´ ëª©ë¡ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- ì•Œë¦¼ í† ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ -->
    <div id="toast-container" class="toast-container"></div>

    <!-- í™•ì¸ ëª¨ë‹¬ -->
    <div id="confirm-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirm-title">í™•ì¸</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirm-message"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-danger" id="confirm-action">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- JavaScript ES6 Modules -->
    <!-- Main script will be loaded at the end -->
    
    <!-- Loading Screen -->
    <div class="loading-screen">
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">
                <h2>ğŸš€ Bitget Trading System v3.0</h2>
                <p>ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì¤‘...</p>
            </div>
            <div class="loading-progress">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="loading-steps">
                    <div class="step active">ì‹œìŠ¤í…œ ë¡œë“œ</div>
                    <div class="step">ì„œë¹„ìŠ¤ ì—°ê²°</div>
                    <div class="step">ì»´í¬ë„ŒíŠ¸ ì´ˆê¸°í™”</div>
                    <div class="step">ì™„ë£Œ</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Error Boundary -->
    <div id="error-boundary" class="error-boundary" style="display: none;">
        <div class="error-content">
            <h2>âš ï¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h2>
            <p class="error-message"></p>
            <button class="error-retry">ë‹¤ì‹œ ì‹œë„</button>
            <button class="error-reload">ìƒˆë¡œê³ ì¹¨</button>
        </div>
    </div>

    <style>
    /* Loading Screen Styles */
    .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--bg-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s ease-out;
    }

    .loading-screen.fade-out {
        opacity: 0;
        pointer-events: none;
    }

    .loading-container {
        text-align: center;
        max-width: 400px;
        padding: 2rem;
    }

    .loading-spinner {
        width: 60px;
        height: 60px;
        border: 4px solid var(--border-color);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 2rem;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .loading-text h2 {
        color: var(--text-primary);
        margin: 0 0 0.5rem;
        font-size: 1.5rem;
    }

    .loading-text p {
        color: var(--text-muted);
        margin: 0 0 2rem;
    }

    .loading-progress {
        width: 100%;
    }

    .progress-bar {
        width: 100%;
        height: 4px;
        background: var(--border-color);
        border-radius: 2px;
        overflow: hidden;
        margin-bottom: 1rem;
    }

    .progress-fill {
        height: 100%;
        background: var(--primary-color);
        width: 0%;
        animation: progress 3s ease-in-out infinite;
    }

    @keyframes progress {
        0% { width: 0%; }
        50% { width: 70%; }
        100% { width: 100%; }
    }

    .loading-steps {
        display: flex;
        justify-content: space-between;
        font-size: 0.875rem;
    }

    .step {
        color: var(--text-muted);
        transition: color 0.3s ease;
    }

    .step.active {
        color: var(--primary-color);
        font-weight: 500;
    }

    /* Toast Styles */
    .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 10000;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .toast {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 1rem;
        max-width: 400px;
        box-shadow: var(--shadow-medium);
        animation: slideIn 0.3s ease-out;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .toast.success { border-left: 4px solid var(--success-color); }
    .toast.warning { border-left: 4px solid var(--warning-color); }
    .toast.error { border-left: 4px solid var(--error-color); }
    .toast.info { border-left: 4px solid var(--info-color); }

    .toast-icon {
        font-size: 1.2rem;
        flex-shrink: 0;
    }

    .toast-content {
        flex: 1;
    }

    .toast-message {
        color: var(--text-primary);
        font-weight: 500;
        margin: 0 0 4px;
    }

    .toast-action {
        background: transparent;
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
        padding: 4px 12px;
        border-radius: 4px;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .toast-action:hover {
        background: var(--primary-color);
        color: white;
    }

    .toast-close {
        background: none;
        border: none;
        color: var(--text-muted);
        cursor: pointer;
        font-size: 1.2rem;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        transition: background 0.2s ease;
    }

    .toast-close:hover {
        background: var(--border-color);
    }

    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

    /* Error Boundary Styles */
    .error-boundary {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10001;
    }

    .error-content {
        background: var(--bg-secondary);
        border-radius: 12px;
        padding: 2rem;
        max-width: 500px;
        text-align: center;
        box-shadow: var(--shadow-large);
    }

    .error-content h2 {
        color: var(--error-color);
        margin: 0 0 1rem;
    }

    .error-message {
        color: var(--text-primary);
        margin: 0 0 2rem;
        line-height: 1.6;
    }

    .error-retry,
    .error-reload {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        margin: 0 8px;
        transition: background 0.2s ease;
    }

    .error-retry:hover,
    .error-reload:hover {
        background: var(--primary-color-dark);
    }

    .error-reload {
        background: var(--border-color);
        color: var(--text-primary);
    }

    .error-reload:hover {
        background: var(--text-muted);
    }

    /* App Loaded State */
    body:not(.app-loaded) .container {
        display: none;
    }

    body.app-loaded .loading-screen {
        display: none;
    }
    </style>

    <!-- ê°•í™”ëœ ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ì‹œìŠ¤í…œ -->
    <script>
        // ES6 ëª¨ë“ˆ ë¡œë“œ ì‹œë„
        let moduleLoaded = false;
        let moduleError = null;
        
        // ëª¨ë“ˆ ë¡œë“œ íƒ€ì„ì•„ì›ƒ
        const moduleTimeout = setTimeout(() => {
            if (!moduleLoaded) {
                console.error('âŒ ëª¨ë“ˆ ë¡œë“œ íƒ€ì„ì•„ì›ƒ');
                forceShowDashboard('module_timeout');
            }
        }, 6000);
        
        // ë™ì  ëª¨ë“ˆ ë¡œë“œ
        async function loadMainModule() {
            try {
                console.log('ğŸ“¦ ë©”ì¸ ëª¨ë“ˆ ë¡œë“œ ì‹œì‘...');
                const module = await import('/dashboard/src/main.js');
                moduleLoaded = true;
                clearTimeout(moduleTimeout);
                console.log('âœ… ë©”ì¸ ëª¨ë“ˆ ë¡œë“œ ì„±ê³µ');
            } catch (error) {
                moduleError = error;
                console.error('âŒ ë©”ì¸ ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨:', error);
                clearTimeout(moduleTimeout);
                
                // Fallback ì‹œìŠ¤í…œ ì‹¤í–‰
                setTimeout(() => {
                    if (!document.body.classList.contains('app-loaded')) {
                        forceShowDashboard('module_error');
                    }
                }, 1000);
            }
        }
        
        // ES6 ëª¨ë“ˆ ì§€ì› í™•ì¸ í›„ ë¡œë“œ
        if ('noModule' in HTMLScriptElement.prototype) {
            // ES6 ëª¨ë“ˆ ì§€ì›
            loadMainModule();
        } else {
            // ES6 ëª¨ë“ˆ ë¯¸ì§€ì›
            console.warn('âš ï¸ ES6 ëª¨ë“ˆ ë¯¸ì§€ì› ë¸Œë¼ìš°ì €');
            setTimeout(() => {
                forceShowDashboard('no_module_support');
            }, 2000);
        }
    </script>
    
    <!-- Fallback for browsers that don't support ES6 modules -->
    <script nomodule>
        console.warn('âš ï¸ ES6 ëª¨ë“ˆ ë¯¸ì§€ì› - Fallback ëª¨ë“œ');
        setTimeout(function() {
            forceShowDashboard('no_module_support');
        }, 3000);
    </script>

    <!-- Global functions for theme and refresh -->
    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Update theme text and icon
            const themeText = document.getElementById('theme-text');
            const themeIcon = document.getElementById('theme-icon');
            if (themeText && themeIcon) {
                themeText.textContent = newTheme === 'dark' ? 'ë‹¤í¬' : 'ë¼ì´íŠ¸';
                themeIcon.className = newTheme === 'dark' ? 'fas fa-moon' : 'fas fa-sun';
            }
        }

        function refreshData() {
            // Trigger refresh event
            if (window.dashboardApp) {
                window.dashboardApp.handleRefreshAll();
            } else {
                location.reload();
            }
        }

        // Initialize theme on load
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
        });

        // ê°•í™”ëœ ë¬´í•œë¡œë”© ë°©ì§€ ì‹œìŠ¤í…œ
        let loadingTimeout;
        let emergencyTimeout;
        let scriptLoadFailed = false;
        
        // 1ì°¨ íƒ€ì„ì•„ì›ƒ: 5ì´ˆ í›„ ê²½ê³ 
        setTimeout(function() {
            const loadingScreen = document.querySelector('.loading-screen');
            if (loadingScreen && loadingScreen.style.display !== 'none' && !document.body.classList.contains('app-loaded')) {
                console.warn('âš ï¸ 5ì´ˆ í›„ì—ë„ ë¡œë”© ì¤‘ - ê³§ ê°•ì œ í‘œì‹œë©ë‹ˆë‹¤');
                
                // ë¡œë”© ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
                const loadingText = document.querySelector('.loading-text p');
                if (loadingText) {
                    loadingText.textContent = 'ì´ˆê¸°í™”ê°€ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤...';
                }
            }
        }, 5000);
        
        // 2ì°¨ íƒ€ì„ì•„ì›ƒ: 8ì´ˆ í›„ ê°•ì œ í‘œì‹œ
        emergencyTimeout = setTimeout(function() {
            const loadingScreen = document.querySelector('.loading-screen');
            if (loadingScreen && !document.body.classList.contains('app-loaded')) {
                console.log('ğŸš¨ Emergency: 8ì´ˆ íƒ€ì„ì•„ì›ƒ - ê°•ì œ ëŒ€ì‹œë³´ë“œ í‘œì‹œ');
                forceShowDashboard('timeout');
            }
        }, 8000);
        
        // 3ì°¨ ì•ˆì „ì¥ì¹˜: 15ì´ˆ í›„ ì™„ì „ ê°•ì œ í‘œì‹œ
        setTimeout(function() {
            if (!document.body.classList.contains('app-loaded')) {
                console.log('ğŸš¨ CRITICAL: 15ì´ˆ íƒ€ì„ì•„ì›ƒ - ì™„ì „ ê°•ì œ í‘œì‹œ');
                forceShowDashboard('critical_timeout');
            }
        }, 15000);
        
        function forceShowDashboard(reason) {
            console.log(`ğŸš¨ ê°•ì œ ëŒ€ì‹œë³´ë“œ í‘œì‹œ - ì›ì¸: ${reason}`);
            
            try {
                // ë¡œë”© í™”ë©´ ìˆ¨ê¸°ê¸°
                const loadingScreen = document.querySelector('.loading-screen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
                
                // ì»¨í…Œì´ë„ˆ ë³´ì´ê¸°
                const container = document.querySelector('.container');
                if (container) {
                    container.style.display = 'block';
                }
                
                // ì•± ë¡œë“œ ì™„ë£Œ í‘œì‹œ
                document.body.classList.add('app-loaded');
                
                // ì—ëŸ¬ ìƒíƒœ í‘œì‹œ
                showEmergencyDashboard(reason);
                
                // íƒ€ì„ì•„ì›ƒ ì •ë¦¬
                if (emergencyTimeout) clearTimeout(emergencyTimeout);
                
            } catch (error) {
                console.error('âŒ ê°•ì œ í‘œì‹œ ì¤‘ ì˜¤ë¥˜:', error);
                // ìµœí›„ì˜ ìˆ˜ë‹¨: í˜ì´ì§€ ë¦¬ë¡œë“œ
                setTimeout(() => location.reload(), 1000);
            }
        }
        
        function showEmergencyDashboard(reason) {
            const container = document.querySelector('.container');
            if (!container) return;
            
            // ì—ëŸ¬ ë°°ë„ˆ ì¶”ê°€
            const errorBanner = document.createElement('div');
            errorBanner.id = 'emergency-banner';
            errorBanner.style.cssText = `
                background: linear-gradient(135deg, #ff4444, #cc0000);
                color: white;
                padding: 1rem;
                text-align: center;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 10000;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            `;
            
            const reasonTexts = {
                'timeout': 'ì´ˆê¸°í™” ì‹œê°„ ì´ˆê³¼',
                'critical_timeout': 'ì‹¬ê°í•œ ë¡œë”© ì§€ì—°',
                'script_error': 'ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨',
                'module_error': 'ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨'
            };
            
            errorBanner.innerHTML = `
                <div style="max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;">
                    <div>
                        <strong>âš ï¸ ê¸´ê¸‰ ëª¨ë“œ:</strong> ${reasonTexts[reason] || reason} - ê¸°ë³¸ ê¸°ëŠ¥ë§Œ ì‚¬ìš© ê°€ëŠ¥
                    </div>
                    <div style="margin-top: 0.5rem;">
                        <button onclick="location.reload()" style="background: white; color: #cc0000; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; margin-right: 0.5rem;">
                            ğŸ”„ ìƒˆë¡œê³ ì¹¨
                        </button>
                        <button onclick="document.getElementById('emergency-banner').style.display='none'" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid white; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">
                            âœ• ìˆ¨ê¸°ê¸°
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertBefore(errorBanner, document.body.firstChild);
            
            // ì»¨í…Œì´ë„ˆ ìƒë‹¨ ë§ˆì§„ ì¶”ê°€
            container.style.marginTop = '80px';
        }
    </script>
</body>
</html>